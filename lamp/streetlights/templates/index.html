<html>
{% load leaflet_tags %}
<head>
<meta charset="utf-8">
<title>Django Lab Girls Copyright FM</title>
    {% leaflet_js %}
    {% leaflet_css %}
    <script src='http://code.jquery.com/jquery-2.1.1.min.js' type="text/javascript"></script>
</head>
<body>
{% leaflet_map "main" callback="main_map_init" %}
</body>
</html>

<script type="text/javascript">
    function main_map_init (map, options) {
        // Use Leaflet API here
        var dataurl = '{% url "data" %}';
        // Download GeoJSON via Ajax
        $.getJSON(dataurl, function (data) {
            // Add GeoJSON layer
            //L.geoJson(data).addTo(map);
        	L.geoJson(data, {
        		onEachFeature: function (feature, layer) {
            		console.log(feature);
            		layer.bindPopup(String(feature.id)+" - "+feature.properties.states);
        		}
    		}).addTo(map);
	});

	var wms = L.tileLayer.wms("http://worldmap.harvard.edu/geoserver/wms", {
        layers: 'geonode:geoname_africa_places',
        format: 'image/png',
        transparent: true,
    });
    var layersControl = L.control.layers();
    layersControl.addOverlay(wms,"Africa places");
    layersControl.addTo(map);
    }
</script>
